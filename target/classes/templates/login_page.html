<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ユーザログイン</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
    <link rel="stylesheet" href="../webjars/bootstrap/3.3.7-1/css/bootstrap.min.css" th:href="@{/webjars/bootstrap/3.3.7-1/css/bootstrap.min.css}" type="text/css"></link>
    <link rel="stylesheet" href="../static/css/dataTables.bootstrap.min.css" th:href="@{/css/dataTables.bootstrap.min.css}" type="text/css"></link>
    <link rel="stylesheet" href="../static/css/common.css" th:href="@{/css/common.css}" type="text/css"></link>
    <script type="text/javascript" src="../webjars/jquery/3.1.1-1/jquery.min.js" th:src="@{/webjars/jquery/3.1.1-1/jquery.min.js}"></script>
    <script type="text/javascript" src="../webjars/bootstrap/3.3.7-1/js/bootstrap.min.js" th:src="@{/webjars/bootstrap/3.3.7-1/js/bootstrap.min.js}"></script>
</head>
<body>
<div class="container" th:replace="common :: def_Header('ユーザログイン')"></div>

<div class="container" style="margin-top:50px;">
	<div class="row">
        <div class="col-md-4 col-md-offset-4">
            <div class="panel panel-default">
                <div class="panel-body">
                    <form id="frmLogin" method="post" th:action="@{'/login_page'}" >
                          <fieldset>
                            <div class="col-md-14 form-group form-inline">
                            	<label class="col-md-4 control-label" for="txtUserCd">ユーザーID</label>
                                <input class="form-control" style="width:60%;" placeholder="ユーザーID &#8727;" autofocus="autofocus" name="txtUserCd" type="text"  value=""
                                	th:id="usrCode" required="required"/>
                            </div>
                            <div class="col-md-14 form-group form-inline">
                            	<label class="col-md-4 control-label" for="txtUserPwd" th:id="usrName">名前</label> 
                            	<label id="lblUsrName" class="control-label" ></label>
                            </div>                            
                            <div class="col-md-14 form-group form-inline">
                            	<label class="col-md-4 control-label" for="txtUserPwd">パスワード</label>
                                <input class="form-control" style="width:60%;" placeholder="パスワード &#8727;" name="txtUserPwd" type="password" value="" required="required" />

                            </div>                          
                            <!-- Change this to a button or input when using this as a form -->
                            <div align="center"><button type="submit" class="btn btn-primary btn-block" style="width:40%;" >ログイン</button></div>                          
                            <div class="row" style="margin-top:15px;">
                            <p class="text-center"><a href="pwd_change.html" 
                            	th:href="@{/pwd_change(usrCode=)}" >パスワード変更はこちら<i class="glyphicon glyphicon-wrench"></i></a></p>
                            </div>
                        </fieldset>
					  </form>
                       <div class="alert alert-danger" role="alert"	th:if="${loginError}">
					    <strong>ログインに失敗しました: </strong>ユーザが存在しないか、パスワードが間違っています。
					  </div>

                </div>
            </div>
        </div>
    </div>
</div>

<div class="container" th:replace="common :: footer"></div>
<script th:inline="javascript">
	/*<![CDATA[*/
		var url = /*[[@{/login/}]]*/'/login/'
		jQuery(function($) {
			$("#usrCode").blur(function(event) {
				event.preventDefault();

				var usrCode = $(this).val();
				getUsrNameByCode(usrCode);
			});

		});
			function getUsrNameByCode(usrCode) {
				if (usrCode == null || usrCode == "") {
					$("#lblUsrName").html("");
					return;
				}
				$.ajax({
					type : "GET",
					url : url+'getUsrName',
					dataType : "json",
					data:{
						usrCode : usrCode
					},
					success : function(data, status, xhr) {
						$('#lblUsrName').html(data.usrName);
					},
					error : function(XMLHttpRequest, status, errorThrown) {
						$('#lblUsrName').html("");
						window.location.href=/*[[@{/session_expired}]]*/"/session_expired";
					}
				});
			}
	
	/*]]>*/
</script>
</body>
</html>